<!-- webkit-test-runner [ SiteIsolationEnabled=true ] -->
<!DOCTYPE html>
<body>
<script>
if (window.testRunner) {
    testRunner.waitUntilDone();
    testRunner.dumpAsText();
}

window.addEventListener("message", function(e) {
    if (e.data !== 'blocked')
        console.log('FAIL: Insecure nested iframe was NOT blocked');

    if (window.testRunner)
        testRunner.notifyDone();
});
</script>

<p>This test embeds a secure iframe which tries to open mixed content.
We should block mixed content even though the parent frame is insecure
because the middle frame is HTTPS.</p>

<script>
onload = function() {
    let ifr = document.createElement("iframe");
    ifr.sandbox = "allow-scripts";
    ifr.src = "https://127.0.0.1:8443/site-isolation/mixedContent/resources/frame-with-insecure-iframe.html";
    document.body.appendChild(ifr);
};
</script>
</body>
